# 1. 01背包

## 例1 [采药](https://www.luogu.com.cn/problem/P1048)

[题面](/题面\p1048.md)

首先，01背包通解就是设  $ dp[i][j] $  为当前放置$i$个物品剩下$j$重量的最大价值，$i$为放入前$i$个物品（不一定全选）,$j$为剩余空间。

设$w[i]$为重量，$v[i]$为价值

则转移表达式为$dp[i][j]=max\{_{dp[i-1][j]}^{dp[i-1][j-w[i]]+v[i](w[i]\le j)}\}$

`注：此方程并非最简`

$j-w[i]$就是放入此物品的容量，而我们需要$剩下j$的容量，所以需要到上一步去借，所以是$dp[i-1][j-w[i]]$

那么 $w[i]\le j$ 就是它能够借到（现在都剩下$j$了，那如果不借那么$dp[i-1]$的 $j < 0$ 了）

核心代码：

```cpp
for(LL i=1;i<=m;i++){//第一步dp要获取i=0的情况,注意要开到下标1开始
    for(LL j=t;j>=0;j--){//注意--
        if(w[i]<=j)
            dp[i][j]=max(dp[i-1][j-w[i]]+v[i],dp[i][j]);
        dp[i][j]=max(dp[i-1][j],dp[i][j]);
    }
}
```

这个方程也可从$0$开始遍历（后面要讲化简，建议从$t$开始）

[完整代码](代码/md/p1048.md)

## 例2  [开心的金明](https://www.luogu.com.cn/problem/P1060)

[题面](题面\p1060.md)

首先，我们改一下定义，设第$i$件的商品价格为$v[i]$重要度为$p[i]$，求买了总共不超过$n$元的商品的$v[i]*p[i]$之和

稍微有点绕

那么我们分个类

|  重量  |    价值     |
| :----: | :---------: |
| $v[i]$ | $v[i]*p[i]$ |

酱紫就可以套入01背包公式了

那么转移表达式就是$dp[i][j]=max\{_{dp[i-1][j]}^{dp[i-1][j-v[i]]+v[i]*p[i](v[i]\le j)}\}$

[示例代码](代码/md/p1060.md)

虽然这可以过，但不够优雅

> 这两道题数据范围都较小，但较大的数据会MLE/TLE，所以我们来将它化简
>
> $dp[i][j]=max\{_{dp[i-1][j]}^{dp[i-1][j-w[i]]+v[i](w[i]\le j)}\}$
>
> 其中$w[i]$为重量，$v[i]$为价值
>
> $ dp[i][j] $  为当前放置$i$个物品剩下$j$重量的最大价值，
>
> $i$为放入前$i$个物品（不一定全选）,$j$为剩余空间。
>
> 由于对$dp[i]$有影响的只有$dp[i-1]$，根据滚动数组的思想，于是我们可以将$i$扔掉
>
> 设$dp[j]$为最大价值，则转移方程为
>
> $dp[j]=max\{dp[j-w[i]]+v[i],dp[j]\}$
>
>

核心代码：

```cpp
    for(LL i=1;i<=m;i++){
        for(LL j=n;j>=0;j--){//注意--,还有必须从容量开始枚举
            if(v[i]<=j)//防止越界
                dp[j]=max(dp[j-v[i]]+v[i]*p[i],dp[j]);
        }
    }
```

 [完整代码](代码/md/p1060plus.md)

## 总结

01背包的方法很简单，基本上就是找$重量$与$价值$，然后套公式，可以根据例2理解这一点

牢记公式：$dp[j]=max\{dp[j-w[i]]+v[i],dp[j]\}$

## 练习

- [P2871 [USACO07DEC]Charm Bracelet S - 洛谷](https://www.luogu.com.cn/problem/P2871)  [题面](题面\p2871.md)  
- [P2170 选学霸 - 洛谷](https://www.luogu.com.cn/problem/P2170) [题面](题面\p2170.md) `注：此题需用到并查集相关知识`

### Charm Bracelet S

物品$n$，容量$m$，重量$w[i]$，价值$d[i]$

一道经典01背包，直接套公式

$dp[j]=max\{dp[j-w[i]]+d[i],dp[j]\}$

然后优雅的打上`return 0;`

 [示例代码](代码/md/p2871.md)

### 选学霸

首先我们用并查集将实力相当的学霸们合并起来，

价值就是相同实力的学霸的个数，

重量可以改一下定义，前$j$个学霸集合

# 2. 完全背包

## 例1
